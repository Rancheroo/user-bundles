namespace: canary-demo
diff:
  comparePatches:
  - apiVersion: v1
    kind: Namespace
    name: canary-demo 
    operations:
    - {"op": "add", "path": "/metadata/labels/istio-injection", "value": "enabled"}
  - apiVersion: apps/v1
    kind: Deployment
    name: prometheus-example-app
    namespace: canary-demo
    operations:
    - {"op":"remove", "path":"/spec/replicas"}
  - apiVersion: v1
    kind: Service
    name: prometheus-example-app
    namespace: canary-demo
    operations:
    - {"op":"remove", "path":"/spec/selector"} 
  - apiVersion: apps/v1
    kind: Deployment
    name: prometheus-example-app-primary
    namespace: canary-demo
    operations:
    - {"op":"remove", "path":"/"}    
  - apiVersion: apps/v1
    kind: Deployment
    name: prometheus-example-app-canary
    namespace: canary-demo
    operations:
    - {"op":"remove", "path":"/"}       